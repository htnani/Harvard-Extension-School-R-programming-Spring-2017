install.packages("cluster")
install.\
install.packages("ISLR")
installed.packages("MASS")
installed.packages("MASS")
installed.packages("ggplot2")
install.packages("ISLR")
install.packages("ggplot2")
install.packages("MASS")
whsAnnBdatNum
read.table("whs2016_AnnexB-data-wo-NAs.txt",sep="\t",header=TRUE,quote="")
getwd()
setwd("D:/HW 6")
read.table("whs2016_AnnexB-data-wo-NAs.txt",sep="\t",header=TRUE,quote="")
whsAnnBdatNum <- read.table("whs2016_AnnexB-data-wo-NAs.txt",sep="\t",header=TRUE,quote="")
pr.out <- prcomp(whsAnnBdatNum, scale = FALSE)
type(pr.out$rotation)
class(pr.out$rotation)
dim(pr.out$rotation)
pr.out$rotation[,1:2]
names(which.max(abs(pr.out$rotation[,1:2])))
which.max(abs(pr.out$rotation[,1:2]))
names(pr.out$rotation[which.max(abs(pr.out$rotation[,1:2]))])
names(pr.out$rotation)
pr.out$rotation
names(pr.out$rotation)
rownames(which.max(abs(pr.out$rotation[,1:2])))
rownames(pr.out$rotation[which.max(abs(pr.out$rotation[,1:2]))])
rownames(pr.out$rotation)[which.max(abs(pr.out$rotation[,1:2]))]
type(whsAnnBdatNum)
class(whsAnnBdatNum)
t(whsAnnBdatNum)
pr.out2 <- prcomp(t(whsAnnBdatNum), scale = FALSE)
rownames(pr.out$rotation)[which.max(abs(pr.out$rotation[,1]))]
rownames(pr.out$rotation)[which.max(abs(pr.out$rotation[,2]))]
library(cluster)
library(ISLR)
library(MASS)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
whsAnnBdatNum <- read.table("whs2016_AnnexB-data-wo-NAs.txt",sep="\t",header=TRUE,quote="")
summary(whsAnnBdatNum[,c(1,4,7,10,17)])
pairs(whsAnnBdatNum[,c(1,4,7,10,17)])
attrmeans <- apply(whsAnnBdatNum, 2, mean)
attrvariances <- apply(whsAnnBdatNum, 2, var)
plot(attrmeans,attrvariances)
plot(attrmeans,attrvariances,log="xy")
attrmeans
plot(pr.out)
biplot(pr.out, scale = 0)
pr.out3 <- (prcomp(whsAnnBdatNum, scale = TRUE))
plot(pr.out3)
biplot(pr.out3, scale = 0)
biplot(pr.out3, scale = 0)
plot(pr.out3)
plot(pr.out3$x[,1:2])
plot(pr.out3$x[,1:3])
plot(pr.out3$x[,1])
plot(pr.out3$x[,1:2])
plot(pr.out3$x[,1:3])
plot(pr.out3$x[,1:2])
?text
plot(pr.out3$x[,1:2])
text(pr.out3$x)
plot(pr.out3$x[,1:2])
plot(pr.out3$x[c("US", "UK", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"),1:2],
)
pr.out3$x[c("US", "UK", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden")]
pr.out3$x
pr.out3$x[c("Sweden")]
pr.out3$x[c("Sweden"),]
pr.out3$x[c("US", "UK")]
pr.out3$x[c("Sweden, Italy")]
pr.out3$x[c("US", "UK"),]
pr.out3$x[c("Sweden, Italy"),]
pr.out3$x[c("Sweden", "Italy"),]
pr.out3$x[c("US", "UK"),]
pr.out3$x[c("Unites States"),]
pr.out3$x[c("United States"),]
pr.out3$x[,1]
pr.out3$x[c("UnitedStatesOfAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden")]
pr.out3$x[c("Sweden", "Italy"),]
pr.out3$x[c("UnitedStatesOfAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"),]
pr.out3$x[c("China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden")]
pr.out3$x[c("China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"),]
pr.out3$x[c("UnitedStatesOfAmerica", China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"),]
pr.out3$x[c("UnitedStatesOfAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"),]
pr.out3$x[c("UnitedStatesOfAmerica"),]
pr.out3$x[c("UnitedStatesofAmerica"),]
pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"),]
plot(pr.out3$x[c("UnitedStatesofAmerica, "UnitedKingdom", China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"),1:2],
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"),1:2],
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"),1:2],
)
biplot(pr.out3, scale = 0)
plot(pr.out3$x[,1:2])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden")])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden")])
?text
?texg
?text
biplot(pr.out3, scale = 0)
plot(pr.out3$x[,1:2])
text(pr.out[1], labels = c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweeden"))
text(pr.out[,1], labels = c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweeden"))
text(pr.out[,1]
)
text(pr.out[,1:2])
text(pr.out[,1]
)
pr.out[,1]
pr.out[,1]
text(pr.out$x[,1], labels = c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweeden"))
text(pr.out$x[,1], labels = c("UnitedStatesofAmerica", "UnitedKingdom", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweeden"))
plot(pr.out3$x[,1:2])
text(pr.out$x[,1], labels = c("UnitedStatesofAmerica", "UnitedKingdom", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweeden"))
text(pr.out$x[,1], labels = c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweeden"))
text(pr.out$x[,1], labels = 1:8
)
plot(pr.out3$x[,1:2])
text(pr.out$x[,1], labels = 1:8
)
text(pr.out$x[,1]
]
pr.out$x[,1]
plot(pr.out3$x[,1:2])
text(pr.out3$x[,1], labels = c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweeden"))
plot(pr.out3$x[,1:2])
text(pr.out3$x[,1], labels = c(1:10)
)
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweeden"), 1:2]
)
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico"), 1:2]
)
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy"), 1:2])
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2], labels = c(UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"))
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2], labels = c(UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"))
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2], labels = names(x[c(UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"))])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2], labels = names(pr.out$x[c(UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"))])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2], labels = names(pr.out3$x))
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2], labels = rownames(pr.out3$x))
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2]))
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2]))
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2], labels = c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"))
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2], labels = c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"))
points(pr.out3$x[!c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
points(pr.out3$x[!(c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden")), 1:2])
?which
points(pr.out$x[,1:2])
plot(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2])
text(pr.out3$x[c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"), 1:2], labels = c("UnitedStatesofAmerica", "UnitedKingdom", "China", "India", "Mexico", "Australia", "Israel", "Italy", "Ireland", "Sweden"))
points(pr.out3$x[,1:2])
pr.out3$rotation[1:2]
pr.out3$rotation
pr.out3$rotation[,1:2]
order(pr.out3$rotation[,1:2])
order(pr.out3$rotation[,1])
order(abs(pr.out3$rotation[,1]))
pr.out4 <- (prcomp(t(whsAnnBdatNum), scale = TRUE))
pr.out4$x[,1:2]
pr.out4$x
pr.out3
pr.out3$x
pr.out4$x[,1:2]
pr.out4$rotation
pr.out3$x
pr.out4$x[,1:2]
pr.out4$x[,1:3]
pr.out4$x[order(df[1,]),1:3]
pr.out4$x[order(df[,1]),1:3]
pr.out4$x[order(df[1]),1:3]
pr.out4$x[order(df[1])]
pr.out4$x[order(df[1]),]
pr.out4$x[order(df[1])]
pr.out4$x[order(pr.out4$x[1,]),1:3]
pr.out4$x[order(pr.out4$x[,1]),1:3]
?kmeans
kmeans2.object <- kmeans(whsAnnBdatNum, 2, nstart = 20)
kmeans2.object
plot(pr.out3$x[,1:2], col=kmeans.object$cluster)
plot(pr.out3$x[,1:2], col=kmeans2.object$cluster)
kmeans2.object <- kmeans(scale(whsAnnBdatNum), 2, nstart = 20)
plot(pr.out3$x[,1:2], col=kmeans2.object$cluster)
?sample
?paste
paste()
set.seed(3)
kmeansset <- list()
# a sampling of 20 country names so as not to clutter the plot
some.country.indexes <- sample(1:nrow(pr.out$x), 10)
for (K in 2:4) {
kmeansset[[K]] <- kmeans(scale(whsAnnBdatNum), K, nstart = 20)
for(i in 1:K) {
i
}
}
for (K in 2:4) {
for(i in 1:K) {
i
}}
for(i in 1:K) {
i}
for (K in 2:4) {
K}
K <-9
K
?print
?which
?paste
?hclust
?plot
?cuttree
?cutree
?table
UCD <- hclust(dist(whsAnnBdatNum, method = "euclidean"), method = "complete")
names(UCD)
kmeans.object
set.seed(1)
set.seed(3)
kmeans.object <- kmeans(scale(whsAnnBdatNum), 4, nstart = 100)
names(kmeans.object)
kmeans.object$cluster
hier4 <- cutree(hclust(dist(scale(whsAnnBdatNum), method = "euclidean"), method = "complete"), 4)
table(hier4, kmeans.object$cluster)
plot(kmeans.object)
plot(pr.out3$x[,1:2], col=kmeans.object$cluster)
plot(pr.out3$x[,1:2], col=hier4)
plot(pr.out3$x[,1:2], col=hier4)
set.seed(1)
hier4 <- cutree(hclust(dist(scale(whsAnnBdatNum), method = "euclidean"), method = "complete"), 4)
plot(pr.out3$x[,1:2], col=hier4)
plot(pr.out3$x[,1:2], col=hier4)
plot(hclust(dist(scale(whsAnnBdatNum), method = "euclidean"), method = "complete"))
plot(pr.out3$x[,1:2], col=hier4)
plot(hclust(dist(scale(whsAnnBdatNum), method = "euclidean"), method = "complete"), )
names(hier4)
rownames(hier4)
hier4
